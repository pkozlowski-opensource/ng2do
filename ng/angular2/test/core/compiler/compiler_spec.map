{"version":3,"sources":["compiler_spec.js","@traceur/generated/TemplateParser/10","@traceur/generated/TemplateParser/7","@traceur/generated/TemplateParser/25"],"names":[],"mappings":"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","file":"d:/work/gitrepos/gh/pkozlowski-opensource/angular/modules/angular2/test/core/compiler/compiler_spec.js","sourceRoot":"d:/work/gitrepos/gh/pkozlowski-opensource/angular/modules/angular2/test/core/compiler/","sourcesContent":["import {describe, beforeEach, it, expect, ddescribe, iit, el, IS_DARTIUM} from 'angular2/test_lib';\n\nimport {DOM, Element, TemplateElement} from 'angular2/src/facade/dom';\nimport {List, ListWrapper, Map, MapWrapper, StringMapWrapper} from 'angular2/src/facade/collection';\nimport {Type, isBlank, stringify, isPresent} from 'angular2/src/facade/lang';\nimport {PromiseWrapper} from 'angular2/src/facade/async';\n\nimport {Compiler, CompilerCache} from 'angular2/src/core/compiler/compiler';\nimport {ProtoView} from 'angular2/src/core/compiler/view';\nimport {DirectiveMetadataReader} from 'angular2/src/core/compiler/directive_metadata_reader';\nimport {Component} from 'angular2/src/core/annotations/annotations';\nimport {Template} from 'angular2/src/core/annotations/template';\nimport {CompileElement} from 'angular2/src/core/compiler/pipeline/compile_element';\nimport {CompileStep} from 'angular2/src/core/compiler/pipeline/compile_step'\nimport {CompileControl} from 'angular2/src/core/compiler/pipeline/compile_control';\nimport {TemplateLoader} from 'angular2/src/core/compiler/template_loader';\nimport {TemplateResolver} from 'angular2/src/core/compiler/template_resolver';\nimport {ComponentUrlMapper, RuntimeComponentUrlMapper} from 'angular2/src/core/compiler/component_url_mapper';\nimport {UrlResolver} from 'angular2/src/core/compiler/url_resolver';\nimport {StyleUrlResolver} from 'angular2/src/core/compiler/style_url_resolver';\n\nimport {Lexer, Parser, dynamicChangeDetection} from 'angular2/change_detection';\nimport {ShadowDomStrategy, NativeShadowDomStrategy} from 'angular2/src/core/compiler/shadow_dom_strategy';\n\nexport function main() {\n  describe('compiler', function() {\n    StringMapWrapper.forEach({\n      '(sync TemplateLoader)': true,\n      '(async TemplateLoader)': false\n    }, (sync, name) => {\n      var reader, tplResolver;\n\n      beforeEach(() => {\n        reader = new DirectiveMetadataReader();\n        tplResolver = new FakeTemplateResolver();\n        if (sync) {\n          tplResolver.forceSync();\n        } else {\n          tplResolver.forceAsync();\n        }\n      });\n\n      describe(name, () => {\n\n        function createCompiler(processClosure) {\n          var steps = [new MockStep(processClosure)];\n          var urlResolver = new FakeUrlResolver();\n          var tplLoader =  new FakeTemplateLoader(urlResolver);\n          return new TestableCompiler(reader, steps,tplLoader, tplResolver,\n            urlResolver, new ComponentUrlMapper());\n        }\n\n        it('should run the steps and return the ProtoView of the root element', (done) => {\n          var rootProtoView = new ProtoView(null, null, null);\n          var compiler = createCompiler( (parent, current, control) => {\n            current.inheritedProtoView = rootProtoView;\n          });\n          tplResolver.setTemplate(MainComponent, new Template({inline: '<div></div>'}));\n          compiler.compile(MainComponent).then( (protoView) => {\n            expect(protoView).toBe(rootProtoView);\n            done();\n          });\n        });\n\n        it('should use the inline template', (done) => {\n          var compiler = createCompiler( (parent, current, control) => {\n            current.inheritedProtoView = new ProtoView(current.element, null, null);\n          });\n          compiler.compile(MainComponent).then( (protoView) => {\n            expect(DOM.getInnerHTML(protoView.element)).toEqual('inline component');\n            done();\n          });\n        });\n\n        it('should wait for async styles to be resolved', (done) => {\n          var styleResolved = false;\n\n          var completer = PromiseWrapper.completer();\n\n          var compiler = createCompiler( (parent, current, control) => {\n            var protoView = new ProtoView(current.element, null, null);\n            ListWrapper.push(protoView.stylePromises, completer.promise.then((_) => {\n              styleResolved = true;\n            }));\n            current.inheritedProtoView = protoView;\n          });\n\n          // It should always return a Promise because the style is async\n          var pvPromise = compiler.compile(MainComponent);\n          expect(pvPromise).toBePromise();\n          expect(styleResolved).toEqual(false);\n\n          // The Promise should resolve after the style is ready\n          completer.resolve(null);\n          pvPromise.then((protoView) => {\n            expect(styleResolved).toEqual(true);\n            done();\n          });\n        });\n\n        it('should load nested components', (done) => {\n          var compiler = createCompiler( (parent, current, control) => {\n            if (DOM.hasClass(current.element, 'nested')) {\n              current.componentDirective = reader.read(NestedComponent);\n              current.inheritedProtoView = parent.inheritedProtoView;\n              current.inheritedElementBinder = current.inheritedProtoView.bindElement(null);\n            } else {\n              current.inheritedProtoView = new ProtoView(current.element, null, null);\n            }\n          });\n          tplResolver.setTemplate(MainComponent, new Template({inline: '<div class=\"nested\"></div>'}));\n          compiler.compile(MainComponent).then( (protoView) => {\n            var nestedView = protoView.elementBinders[0].nestedProtoView;\n            expect(DOM.getInnerHTML(nestedView.element)).toEqual('nested component');\n            done();\n          });\n        });\n\n        it('should cache compiled components', (done) => {\n          var compiler = createCompiler( (parent, current, control) => {\n            current.inheritedProtoView = new ProtoView(current.element, null, null);\n          });\n          var firstProtoView;\n          tplResolver.setTemplate(MainComponent, new Template({inline: '<div></div>'}));\n          compiler.compile(MainComponent).then( (protoView) => {\n            firstProtoView = protoView;\n            return compiler.compile(MainComponent);\n          }).then( (protoView) => {\n            expect(firstProtoView).toBe(protoView);\n            done();\n          });\n        });\n\n        it('should re-use components being compiled', (done) => {\n          var nestedElBinders = [];\n          var compiler = createCompiler( (parent, current, control) => {\n            current.inheritedProtoView = new ProtoView(current.element, null, null);\n            if (DOM.hasClass(current.element, 'nested')) {\n              current.inheritedElementBinder = current.inheritedProtoView.bindElement(null);\n              current.componentDirective = reader.read(NestedComponent);\n              ListWrapper.push(nestedElBinders, current.inheritedElementBinder);\n            }\n          });\n          tplResolver.setTemplate(MainComponent,\n            new Template({inline: '<div><div class=\"nested\"></div><div class=\"nested\"></div></div>'}));\n          compiler.compile(MainComponent).then( (protoView) => {\n            expect(nestedElBinders[0].nestedProtoView).toBe(nestedElBinders[1].nestedProtoView);\n            done();\n          });\n        });\n\n        it('should allow recursive components', (done) => {\n          var compiler = createCompiler( (parent, current, control) => {\n            current.inheritedProtoView = new ProtoView(current.element, null, null);\n            current.inheritedElementBinder = current.inheritedProtoView.bindElement(null);\n            current.componentDirective = reader.read(RecursiveComponent);\n          });\n          compiler.compile(RecursiveComponent).then( (protoView) => {\n            expect(protoView.elementBinders[0].nestedProtoView).toBe(protoView);\n            done();\n          });\n        });\n      });\n    });\n\n    describe('(mixed async, sync TemplateLoader)', () => {\n      var reader = new DirectiveMetadataReader();\n\n      function createCompiler(processClosure, templateResolver: TemplateResolver) {\n        var steps = [new MockStep(processClosure)];\n        var urlResolver = new FakeUrlResolver();\n        var tplLoader = new FakeTemplateLoader(urlResolver);\n        return new TestableCompiler(reader, steps, tplLoader, templateResolver,\n          urlResolver, new ComponentUrlMapper());\n      }\n\n      function createNestedComponentSpec(name, resolver: TemplateResolver, error:string = null) {\n        it(`should load nested components ${name}`, (done) => {\n\n          var compiler = createCompiler((parent, current, control) => {\n            if (DOM.hasClass(current.element, 'parent')) {\n              current.componentDirective = reader.read(NestedComponent);\n              current.inheritedProtoView = parent.inheritedProtoView;\n              current.inheritedElementBinder = current.inheritedProtoView.bindElement(null);\n            } else {\n              current.inheritedProtoView = new ProtoView(current.element, null, null);\n            }\n          }, resolver);\n\n          PromiseWrapper.then(compiler.compile(ParentComponent),\n            function(protoView) {\n              var nestedView = protoView.elementBinders[0].nestedProtoView;\n              expect(error).toBeNull();\n              expect(DOM.getInnerHTML(nestedView.element)).toEqual('nested component');\n              done();\n            },\n            function(compileError) {\n              expect(compileError.message).toEqual(error);\n              done();\n            }\n          );\n        });\n      }\n\n      var templateResolver = new FakeTemplateResolver();\n      templateResolver.setSync(ParentComponent);\n      templateResolver.setSync(NestedComponent);\n      createNestedComponentSpec('(sync -> sync)', templateResolver);\n\n      templateResolver = new FakeTemplateResolver();\n      templateResolver.setAsync(ParentComponent);\n      templateResolver.setSync(NestedComponent);\n      createNestedComponentSpec('(async -> sync)', templateResolver);\n\n      templateResolver = new FakeTemplateResolver();\n      templateResolver.setSync(ParentComponent);\n      templateResolver.setAsync(NestedComponent);\n      createNestedComponentSpec('(sync -> async)', templateResolver);\n\n      templateResolver = new FakeTemplateResolver();\n      templateResolver.setAsync(ParentComponent);\n      templateResolver.setAsync(NestedComponent);\n      createNestedComponentSpec('(async -> async)', templateResolver);\n\n      templateResolver = new FakeTemplateResolver();\n      templateResolver.setError(ParentComponent);\n      templateResolver.setSync(NestedComponent);\n      createNestedComponentSpec('(error -> sync)', templateResolver,\n        'Failed to load the template for ParentComponent');\n\n      // TODO(vicb): Check why errors this fails with Dart\n      // TODO(vicb): The Promise is rejected with the correct error but an exc is thrown before\n      //templateResolver = new FakeTemplateResolver();\n      //templateResolver.setSync(ParentComponent);\n      //templateResolver.setError(NestedComponent);\n      //createNestedComponentSpec('(sync -> error)', templateResolver,\n      //  'Failed to load the template for NestedComponent -> Failed to compile ParentComponent');\n      //\n      //templateResolver = new FakeTemplateResolver();\n      //templateResolver.setAsync(ParentComponent);\n      //templateResolver.setError(NestedComponent);\n      //createNestedComponentSpec('(async -> error)', templateResolver,\n      //  'Failed to load the template for NestedComponent -> Failed to compile ParentComponent');\n\n    });\n\n    describe('URL resolution', () => {\n      it('should resolve template URLs by combining application, component and template URLs', (done) => {\n        var steps = [new MockStep((parent, current, control) => {\n          current.inheritedProtoView = new ProtoView(current.element, null, null);\n        })];\n        var reader = new DirectiveMetadataReader();\n        var tplResolver = new FakeTemplateResolver();\n        var urlResolver = new FakeUrlResolver();\n        var tplLoader = new FakeTemplateLoader(urlResolver);\n        var template = new Template({inline: '<div></div>', url: '/tpl.html'});\n        var cmpUrlMapper = new RuntimeComponentUrlMapper();\n        cmpUrlMapper.setComponentUrl(MainComponent, '/cmp');\n\n        var compiler = new TestableCompiler(reader, steps, tplLoader, tplResolver,\n          urlResolver, cmpUrlMapper);\n\n        tplResolver.forceSync();\n        tplResolver.setTemplate(MainComponent, template);\n        compiler.compile(MainComponent).then((protoView) => {\n          expect(tplLoader.getTemplateUrl(template)).toEqual('http://www.app.com/cmp/tpl.html');\n          done();\n        });\n      })\n    });\n  });\n}\n\n@Component()\n@Template({inline: '<div class=\"parent\"></div>'})\nclass ParentComponent {}\n\n@Component()\n@Template({inline: 'inline component'})\nclass MainComponent {}\n\n@Component()\n@Template({inline: 'nested component'})\nclass NestedComponent {}\n\n@Component({selector: 'rec-comp'})\n@Template({inline: '<div rec-comp></div>'})\nclass RecursiveComponent {}\n\nclass TestableCompiler extends Compiler {\n  steps:List;\n\n  constructor(reader:DirectiveMetadataReader, steps:List<CompileStep>, loader: TemplateLoader,\n    templateResolver: TemplateResolver, urlResolver: UrlResolver, cmpUrlMapper: ComponentUrlMapper) {\n    super(dynamicChangeDetection,\n          loader,\n          reader,\n          new Parser(new Lexer()),\n          new CompilerCache(),\n          new NativeShadowDomStrategy(new StyleUrlResolver(urlResolver)),\n          templateResolver,\n          cmpUrlMapper,\n          urlResolver);\n\n    this.steps = steps;\n  }\n\n  createSteps(component:Type, template: Template):List<CompileStep> {\n    return this.steps;\n  }\n}\n\nclass MockStep extends CompileStep {\n  processClosure:Function;\n  constructor(process) {\n    super();\n    this.processClosure = process;\n  }\n  process(parent:CompileElement, current:CompileElement, control:CompileControl) {\n    this.processClosure(parent, current, control);\n  }\n}\n\nclass FakeUrlResolver extends UrlResolver {\n  constructor() {\n    super();\n  }\n\n  resolve(baseUrl: string, url: string): string {\n    if (baseUrl === null && url == './') {\n      return 'http://www.app.com';\n    };\n\n    return baseUrl + url;\n  }\n}\n\nclass FakeTemplateLoader extends TemplateLoader {\n  constructor(urlResolver: UrlResolver) {\n    super(null, urlResolver);\n  }\n\n  load(template: Template) {\n    if (isPresent(template.inline)) {\n      return DOM.createTemplate(template.inline);\n    }\n\n    if (isPresent(template.url)) {\n      var tplElement = DOM.createTemplate(template.url);\n      return PromiseWrapper.resolve(tplElement);\n    }\n\n    return PromiseWrapper.reject('Fail to load');\n  }\n}\n\nclass FakeTemplateResolver extends TemplateResolver {\n  _forceSync: boolean;\n  _forceAsync: boolean;\n  _cmpTemplates: Map;\n  _syncCmp: List<Type>;\n  _asyncCmp: List<Type>;\n  _errorCmp: List<Type>;\n\n  constructor() {\n    super();\n    this._forceSync = false;\n    this._forceAsync = false;\n    this._syncCmp = [];\n    this._asyncCmp = [];\n    this._errorCmp = [];\n    this._cmpTemplates = MapWrapper.create();\n  }\n\n  resolve(component: Type): Template {\n    var template = MapWrapper.get(this._cmpTemplates, component);\n    if (isBlank(template)) {\n      template = super.resolve(component);\n    }\n\n    var html = template.inline;\n\n    if (isBlank(template.inline)) {\n      throw 'The tested component must define an inline template';\n    }\n\n    if (ListWrapper.contains(this._errorCmp, component)) {\n      return new Template({url: null, inline: null});\n    }\n\n    if (ListWrapper.contains(this._syncCmp, component)) {\n      return template;\n    }\n\n    if (ListWrapper.contains(this._asyncCmp, component)) {\n      return new Template({url: html});\n    }\n\n    if (this._forceSync) return template;\n    if (this._forceAsync) return new Template({url: html});\n\n    throw 'No template';\n  }\n\n  forceSync() {\n    this._forceSync = true;\n    this._forceAsync = false;\n  }\n\n  forceAsync() {\n    this._forceAsync = true;\n    this._forceSync = false;\n  }\n\n  setSync(component: Type) {\n    ListWrapper.push(this._syncCmp, component);\n  }\n\n  setAsync(component: Type) {\n    ListWrapper.push(this._asyncCmp, component);\n  }\n\n  setError(component: Type) {\n    ListWrapper.push(this._errorCmp, component);\n  }\n\n  setTemplate(component: Type, template: Template) {\n    MapWrapper.set(this._cmpTemplates, component, template);\n  }\n}\n","Object.defineProperty($__placeholder__0, $__placeholder__1,\n        {get: function() {return $__placeholder__2}});","assert.type.$__placeholder__0)","assert.genericType($__placeholder__0)"]}